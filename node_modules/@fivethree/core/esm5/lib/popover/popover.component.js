/**
 * @fileoverview added by tsickle
 * Generated from: lib/popover/popover.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { animIn, animOut } from './popover.animations';
import { DomSanitizer } from '@angular/platform-browser';
import { Component, ViewChild, Input, ViewEncapsulation, Host, Optional, ElementRef } from '@angular/core';
import { FivOverlay } from '../overlay/overlay.component';
import { Platform, IonContent } from '@ionic/angular';
import { fromEvent, Subject, merge, from } from 'rxjs';
import { tap, takeUntil, map, throttleTime, filter, flatMap } from 'rxjs/operators';
import { NavigationStart, Router } from '@angular/router';
import { after } from '@fivethree/ngx-rxjs-animations';
var FivPopover = /** @class */ (function () {
    function FivPopover(platform, content, dom, router) {
        var _this = this;
        this.platform = platform;
        this.content = content;
        this.dom = dom;
        this.router = router;
        this.arrow = false;
        this.arrowWidth = 24;
        this.arrowHeight = this.arrowWidth / 1.6;
        this.arrowPosition = 'auto';
        this.backdrop = true;
        this.overlaysTarget = true;
        this.closeOnNavigation = true;
        this.scrollToTarget = false;
        this.scrollSpeed = 100;
        this.position = 'auto';
        this.classes = [];
        this.hidden = false;
        this.onDestroy$ = new Subject();
        this.onClose$ = new Subject();
        this.inDuration = 200;
        this.outDuration = 80;
        this.animationIn = (/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            return animIn(element, _this._position, _this.inDuration);
        });
        this.animationOut = (/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            return animOut(element, _this.outDuration);
        });
    }
    Object.defineProperty(FivPopover.prototype, "styles", {
        get: /**
         * @return {?}
         */
        function () {
            if (!this._position) {
                return;
            }
            return this.dom.bypassSecurityTrustStyle(" width: " + (this.width ? this.width + 'px' : 'auto') + "; \n        height: " + (this.height ? this.height + 'px' : 'auto') + "; \n        left: " + this.getContainerLeft() + "px; \n        top: " + this.getContainerTop() + "px;");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FivPopover.prototype, "triangle", {
        get: /**
         * @return {?}
         */
        function () {
            var _this = this;
            /** @type {?} */
            var isHorizontal = ['left', 'right'].some((/**
             * @param {?} s
             * @return {?}
             */
            function (s) { return s === _this.position; }));
            if (isHorizontal) {
                return this.arrowHeight + ",0 0," + this.arrowWidth / 2 + " " + this.arrowHeight + "," + this.arrowWidth;
            }
            return "0," + this.arrowHeight + " " + this.arrowWidth / 2 + ",0 " + this.arrowWidth + "," + this.arrowHeight;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FivPopover.prototype, "svgStyles", {
        get: /**
         * @return {?}
         */
        function () {
            var _this = this;
            if (!this._position) {
                return;
            }
            /** @type {?} */
            var isHorizontal = ['left', 'right'].some((/**
             * @param {?} s
             * @return {?}
             */
            function (s) { return s === _this.position; }));
            /** @type {?} */
            var rotate = (this.position === 'auto' && this._position.vertical === 'bottom') ||
                this.position === 'left';
            return this.dom.bypassSecurityTrustStyle("height: " + (isHorizontal ? this.arrowWidth : this.arrowHeight) + "px; \n      width: " + (isHorizontal ? this.arrowHeight : this.arrowWidth) + "px; \n      top: " + this.getArrowTop() + "px; \n      left: " + this.getArrowLeft() + "px;\n      transform: rotateZ(" + (rotate ? 180 : 0) + "deg);");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FivPopover.prototype, "animationStyles", {
        get: /**
         * @return {?}
         */
        function () {
            if (!this._position) {
                return;
            }
            return this.dom.bypassSecurityTrustStyle("height: " + this.arrowHeight + "px; \n      width: " + this.arrowWidth + "px; \n      top: " + this.getArrowTop() + "px; \n      left: " + this.getArrowLeft() + "px;\n      transform: rotateZ(" + (this._position.vertical === 'bottom' ? 180 : 0) + "deg);");
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FivPopover.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.router.events
            .pipe(filter((/**
         * @param {?} event
         * @return {?}
         */
        function (event) { return event instanceof NavigationStart; })), filter((/**
         * @return {?}
         */
        function () { return _this.closeOnNavigation && _this.overlay.open; })), tap((/**
         * @return {?}
         */
        function () { return _this.close(); })), takeUntil(this.onDestroy$))
            .subscribe();
    };
    /**
     * @return {?}
     */
    FivPopover.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    FivPopover.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.onDestroy$.next();
    };
    /**
     * @return {?}
     */
    FivPopover.prototype.close = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.animationOut(this.animationContainer)
            .pipe(after((/**
         * @return {?}
         */
        function () {
            _this.overlay.hide();
            _this.onClose$.next();
        })))
            .subscribe();
    };
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    FivPopover.prototype.getPositionOfTarget = /**
     * @private
     * @param {?} target
     * @return {?}
     */
    function (target) {
        /** @type {?} */
        var rect = target.getBoundingClientRect();
        return this.calculcatePositioning(rect.top, rect.left, rect.bottom, rect.right, rect.height, rect.width);
    };
    /**
     * @param {?} target
     * @return {?}
     */
    FivPopover.prototype.open = /**
     * @param {?} target
     * @return {?}
     */
    function (target) {
        /** @type {?} */
        var element;
        if (target instanceof MouseEvent) {
            element = (/** @type {?} */ (target.target));
        }
        else if (target instanceof ElementRef) {
            element = (/** @type {?} */ (target.nativeElement));
        }
        else {
            return;
        }
        this.openTarget(element);
    };
    /**
     * @param {?} target
     * @return {?}
     */
    FivPopover.prototype.openTarget = /**
     * @param {?} target
     * @return {?}
     */
    function (target) {
        /** @type {?} */
        var position = this.getPositionOfTarget(target);
        this.openAtPosition(target, position);
        this.watchResize(target);
        this.watchScroll(target);
    };
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    FivPopover.prototype.watchResize = /**
     * @private
     * @param {?} target
     * @return {?}
     */
    function (target) {
        var _this = this;
        fromEvent(window, 'resize')
            .pipe(flatMap((/**
         * @return {?}
         */
        function () { return _this.filterInViewport(target); })), throttleTime(50), map((/**
         * @return {?}
         */
        function () { return _this.getPositionOfTarget(target); })), tap((/**
         * @param {?} pos
         * @return {?}
         */
        function (pos) { return (_this._position = pos); })), takeUntil(this.onDestroy$))
            .subscribe();
    };
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    FivPopover.prototype.watchScroll = /**
     * @private
     * @param {?} target
     * @return {?}
     */
    function (target) {
        var _this = this;
        if (this.content && !this.backdrop) {
            this.content.scrollEvents = true;
            merge(fromEvent(window, 'mousewheel'), fromEvent(window, 'touchmove'), this.content.ionScroll)
                .pipe(flatMap((/**
             * @return {?}
             */
            function () { return _this.filterInViewport(target); })), map((/**
             * @return {?}
             */
            function () { return _this.getPositionOfTarget(target); })), tap((/**
             * @param {?} pos
             * @return {?}
             */
            function (pos) { return (_this._position = pos); })), takeUntil(this.onDestroy$))
                .subscribe();
        }
    };
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    FivPopover.prototype.filterInViewport = /**
     * @private
     * @param {?} target
     * @return {?}
     */
    function (target) {
        var _this = this;
        return from(this.inViewport(target.getBoundingClientRect())).pipe(tap((/**
         * @param {?} inViewport
         * @return {?}
         */
        function (inViewport) {
            return !inViewport ? (_this.hidden = true) : (_this.hidden = false);
        })), filter((/**
         * @param {?} inViewPort
         * @return {?}
         */
        function (inViewPort) { return _this.overlay.open && inViewPort; })));
    };
    /**
     * @private
     * @param {?} target
     * @param {?} position
     * @return {?}
     */
    FivPopover.prototype.openAtPosition = /**
     * @private
     * @param {?} target
     * @param {?} position
     * @return {?}
     */
    function (target, position) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.scrollToPosition(target, position)];
                    case 1:
                        _a.sent();
                        this._position = position;
                        this.overlay.show();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @private
     * @param {?} target
     * @param {?} position
     * @return {?}
     */
    FivPopover.prototype.scrollToPosition = /**
     * @private
     * @param {?} target
     * @param {?} position
     * @return {?}
     */
    function (target, position) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var isInViewport;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.content && this.scrollToTarget)) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.inViewport(target.getBoundingClientRect())];
                    case 1:
                        isInViewport = _a.sent();
                        if (isInViewport) {
                            return [2 /*return*/];
                        }
                        return [4 /*yield*/, this.content.scrollToPoint(position.left, position.top, this.scrollSpeed)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @param {?} position
     * @return {?}
     */
    FivPopover.prototype.inViewport = /**
     * @param {?} position
     * @return {?}
     */
    function (position) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var height, width;
            return tslib_1.__generator(this, function (_a) {
                height = this.platform.height();
                width = this.platform.width();
                return [2 /*return*/, (position.top <= height &&
                        position.bottom >= 0 &&
                        position.left < width &&
                        position.right > 0)];
            });
        });
    };
    /**
     * @private
     * @param {?} top
     * @param {?} left
     * @param {?} bottom
     * @param {?} right
     * @param {?} targetHeight
     * @param {?} targetWidth
     * @return {?}
     */
    FivPopover.prototype.calculcatePositioning = /**
     * @private
     * @param {?} top
     * @param {?} left
     * @param {?} bottom
     * @param {?} right
     * @param {?} targetHeight
     * @param {?} targetWidth
     * @return {?}
     */
    function (top, left, bottom, right, targetHeight, targetWidth) {
        // calculates the position of the popover without considering arrow and overlay offset
        /** @type {?} */
        var width = this.platform.width();
        /** @type {?} */
        var height = this.platform.height();
        /** @type {?} */
        var _left = this.position === 'right' ||
            (width / 2 > left && this.position !== 'left');
        /** @type {?} */
        var _right = this.position === 'left' ||
            (width / 2 <= left && this.position !== 'right');
        /** @type {?} */
        var _top = this.position === 'below' ||
            (height / 2 > top && this.position !== 'above');
        /** @type {?} */
        var _bottom = this.position === 'above' ||
            (height / 2 <= top && this.position !== 'below');
        // transform origin
        /** @type {?} */
        var horizontal = 'left';
        /** @type {?} */
        var vertical = 'top';
        if (_left && _top) {
            // top left
            horizontal = 'left';
            vertical = 'top';
        }
        else if (_right && _bottom) {
            // bottom right
            left = right - this.width;
            top = bottom - this.height;
            horizontal = 'right';
            vertical = 'bottom';
        }
        else if (_right && _top) {
            // top right
            left = right - this.width;
            horizontal = 'right';
            vertical = 'top';
        }
        else if (_left && _bottom) {
            // bottom left
            top = bottom - this.height;
            horizontal = 'left';
            vertical = 'bottom';
        }
        return {
            top: top,
            left: left,
            bottom: bottom,
            right: right,
            targetHeight: targetHeight,
            targetWidth: targetWidth,
            horizontal: horizontal,
            vertical: vertical
        };
    };
    /**
     * @private
     * @return {?}
     */
    FivPopover.prototype.getArrowTop = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var isVert = ['auto', 'below', 'above'].some((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s === _this.position; }));
        if (isVert) {
            return this._position.vertical === 'top'
                ? -1 * this.arrowHeight
                : this.height;
        }
        if (this.arrowPosition === 'center') {
            return this.height / 2 - this.arrowWidth / 2;
        }
        return this._position.vertical === 'top'
            ? this._position.targetHeight / 2 - this.arrowHeight / 2
            : this.height - this.arrowHeight / 2 - this._position.targetHeight / 2;
    };
    /**
     * @private
     * @return {?}
     */
    FivPopover.prototype.getArrowLeft = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var isHorizontal = ['left', 'right'].some((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s === _this.position; }));
        if (isHorizontal) {
            return this._position.horizontal === 'left'
                ? -1 * this.arrowHeight
                : this.width;
        }
        if (this.arrowPosition === 'center') {
            return this.width / 2 - this.arrowHeight / 2;
        }
        return this._position.horizontal === 'left'
            ? this._position.targetWidth / 2 - this.arrowWidth / 2
            : this.width - this.arrowWidth / 2 - this._position.targetWidth / 2;
    };
    /**
     * @private
     * @return {?}
     */
    FivPopover.prototype.getContainerTop = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var isVert = ['auto', 'below', 'above'].some((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s === _this.position; }));
        /** @type {?} */
        var isTop = this._position.vertical === 'top';
        /** @type {?} */
        var offset = 0;
        if (this.arrow && isTop) {
            offset -= this.getVerticalArrowOffset();
        }
        else if (this.arrow && !isTop) {
            offset += this.getVerticalArrowOffset();
        }
        if (!isVert) {
            return this._position.top + offset;
        }
        if (!this.overlaysTarget && isTop) {
            offset += this._position.targetHeight;
        }
        else if (!this.overlaysTarget && !isTop) {
            offset -= this._position.targetHeight;
        }
        if (this.arrow && isTop) {
            offset += this.arrowHeight;
        }
        else if (this.arrow && !isTop) {
            offset -= this.arrowHeight;
        }
        return this._position.top + offset;
    };
    /**
     * @private
     * @return {?}
     */
    FivPopover.prototype.getVerticalArrowOffset = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var offset = 0;
        /** @type {?} */
        var isHorizontal = ['left', 'right'].some((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s === _this.position; }));
        if (this.arrowPosition === 'center' && isHorizontal) {
            offset += this.height / 2 - this._position.targetHeight / 2;
        }
        return offset;
    };
    /**
     * @private
     * @return {?}
     */
    FivPopover.prototype.getHorizontalArrowOffset = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var offset = 0;
        /** @type {?} */
        var isVertical = ['above', 'auto', 'below'].some((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s === _this.position; }));
        if (this.arrowPosition === 'center' && isVertical) {
            offset += this.width / 2 - this._position.targetWidth / 2;
        }
        return offset;
    };
    /**
     * @private
     * @return {?}
     */
    FivPopover.prototype.getContainerLeft = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var isHorizontal = ['left', 'right'].some((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s === _this.position; }));
        /** @type {?} */
        var isLeft = this._position.horizontal === 'left';
        /** @type {?} */
        var offset = 0;
        if (this.arrow && isLeft) {
            offset -= this.getHorizontalArrowOffset();
        }
        else if (this.arrow && !isLeft) {
            offset += this.getHorizontalArrowOffset();
        }
        if (!isHorizontal) {
            return this._position.left + offset;
        }
        if (!this.overlaysTarget && isLeft) {
            offset += this._position.targetWidth;
        }
        else if (!this.overlaysTarget && !isLeft) {
            offset -= this._position.targetWidth;
        }
        if (this.arrow && isLeft) {
            offset += this.arrowHeight;
        }
        else if (this.arrow && !isLeft) {
            offset -= this.arrowHeight;
        }
        return this._position.left + offset;
    };
    FivPopover.decorators = [
        { type: Component, args: [{
                    selector: 'fiv-popover',
                    template: "<fiv-overlay>\n  <div *ngIf=\"backdrop && !hidden\" [ngClass]=\"classes\" class=\"fiv-popover-backdrop\" (click)=\"close()\">\n  </div>\n  <div *ngIf=\"!hidden\" [ngClass]=\"classes\" class=\"popover-container\" [style]=\"styles\">\n    <div #animation *ngIf=\"overlay?.open\" class=\"animation-container\" anim [anim.in]=\"animationIn\">\n      <ng-content>\n      </ng-content>\n      <svg *ngIf=\"arrow && !overlaysTarget\" class=\"arrow\" [style]=\"svgStyles\">\n        <polygon [attr.points]=\"triangle\" />\n      </svg>\n    </div>\n\n  </div>\n\n</fiv-overlay>",
                    encapsulation: ViewEncapsulation.None,
                    styles: [":host{--fiv-popover-backdrop-color:rgba(0, 0, 0, 0.2)}.popover-container{position:absolute;display:block}.animation-container{height:100%;position:relative}svg.arrow{position:absolute;fill:var(--ion-item-background)}.fiv-popover-backdrop{position:absolute;display:block;width:100vw;height:100vh;background:var(--fiv-popover-backdrop-color)}"]
                }] }
    ];
    /** @nocollapse */
    FivPopover.ctorParameters = function () { return [
        { type: Platform },
        { type: IonContent, decorators: [{ type: Host }, { type: Optional }] },
        { type: DomSanitizer },
        { type: Router }
    ]; };
    FivPopover.propDecorators = {
        overlay: [{ type: ViewChild, args: [FivOverlay, { static: false },] }],
        animationContainer: [{ type: ViewChild, args: ['animation', { static: false },] }],
        width: [{ type: Input }],
        height: [{ type: Input }],
        arrow: [{ type: Input }],
        arrowWidth: [{ type: Input }],
        arrowHeight: [{ type: Input }],
        arrowPosition: [{ type: Input }],
        backdrop: [{ type: Input }],
        overlaysTarget: [{ type: Input }],
        closeOnNavigation: [{ type: Input }],
        scrollToTarget: [{ type: Input }],
        scrollSpeed: [{ type: Input }],
        position: [{ type: Input }],
        classes: [{ type: Input }],
        inDuration: [{ type: Input }],
        outDuration: [{ type: Input }],
        animationIn: [{ type: Input }],
        animationOut: [{ type: Input }]
    };
    return FivPopover;
}());
export { FivPopover };
if (false) {
    /** @type {?} */
    FivPopover.prototype.overlay;
    /** @type {?} */
    FivPopover.prototype.animationContainer;
    /** @type {?} */
    FivPopover.prototype.width;
    /** @type {?} */
    FivPopover.prototype.height;
    /** @type {?} */
    FivPopover.prototype.arrow;
    /** @type {?} */
    FivPopover.prototype.arrowWidth;
    /** @type {?} */
    FivPopover.prototype.arrowHeight;
    /** @type {?} */
    FivPopover.prototype.arrowPosition;
    /** @type {?} */
    FivPopover.prototype.backdrop;
    /** @type {?} */
    FivPopover.prototype.overlaysTarget;
    /** @type {?} */
    FivPopover.prototype.closeOnNavigation;
    /** @type {?} */
    FivPopover.prototype.scrollToTarget;
    /** @type {?} */
    FivPopover.prototype.scrollSpeed;
    /** @type {?} */
    FivPopover.prototype.position;
    /** @type {?} */
    FivPopover.prototype.classes;
    /** @type {?} */
    FivPopover.prototype._position;
    /** @type {?} */
    FivPopover.prototype.hidden;
    /** @type {?} */
    FivPopover.prototype.onDestroy$;
    /** @type {?} */
    FivPopover.prototype.onClose$;
    /** @type {?} */
    FivPopover.prototype.inDuration;
    /** @type {?} */
    FivPopover.prototype.outDuration;
    /** @type {?} */
    FivPopover.prototype.animationIn;
    /** @type {?} */
    FivPopover.prototype.animationOut;
    /**
     * @type {?}
     * @private
     */
    FivPopover.prototype.platform;
    /**
     * @type {?}
     * @private
     */
    FivPopover.prototype.content;
    /**
     * @type {?}
     * @private
     */
    FivPopover.prototype.dom;
    /**
     * @type {?}
     * @private
     */
    FivPopover.prototype.router;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wb3Zlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZml2ZXRocmVlL2NvcmUvIiwic291cmNlcyI6WyJsaWIvcG9wb3Zlci9wb3BvdmVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN6RCxPQUFPLEVBQ0wsU0FBUyxFQUVULFNBQVMsRUFDVCxLQUFLLEVBQ0wsaUJBQWlCLEVBQ2pCLElBQUksRUFDSixRQUFRLEVBRVIsVUFBVSxFQUVYLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdkQsT0FBTyxFQUNMLEdBQUcsRUFDSCxTQUFTLEVBQ1QsR0FBRyxFQUNILFlBQVksRUFDWixNQUFNLEVBQ04sT0FBTyxFQUNSLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEIsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQVExRCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFdkQ7SUEwRkUsb0JBQ1UsUUFBa0IsRUFDRSxPQUFtQixFQUN2QyxHQUFpQixFQUNqQixNQUFjO1FBSnhCLGlCQUtJO1FBSk0sYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNFLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFDdkMsUUFBRyxHQUFILEdBQUcsQ0FBYztRQUNqQixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBbEZmLFVBQUssR0FBRyxL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LGlCQUFpQixDQUFDLElBQUk7O2lCQUN0Qzs7OztnQkF6QlEsUUFBUTtnQkFBRSxVQUFVLHVCQWdIeEIsSUFBSSxZQUFJLFFBQVE7Z0JBOUhaLFlBQVk7Z0JBd0JLLE1BQU07OzswQkFpQjdCLFNBQVMsU0FBQyxVQUFVLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFO3FDQUN2QyxTQUFTLFNBQUMsV0FBVyxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRTt3QkFFeEMsS0FBSzt5QkFDTCxLQUFLO3dCQUNMLEtBQUs7NkJBQ0wsS0FBSzs4QkFDTCxLQUFLO2dDQUNMLEtBQUs7MkJBQ0wsS0FBSztpQ0FDTCxLQUFLO29DQUNMLEtBQUs7aUNBQ0wsS0FBSzs4QkFDTCxLQUFLOzJCQUNMLEtBQUs7MEJBQ0wsS0FBSzs2QkFPTCxLQUFLOzhCQUNMLEtBQUs7OEJBQ0wsS0FBSzsrQkFFTCxLQUFLOztJQTRXUixpQkFBQztDQUFBLEFBN1lELElBNllDO1NBdllZLFVBQVU7OztJQUNyQiw2QkFBOEQ7O0lBQzlELHdDQUEwRTs7SUFFMUUsMkJBQXVCOztJQUN2Qiw0QkFBd0I7O0lBQ3hCLDJCQUF1Qjs7SUFDdkIsZ0NBQXlCOztJQUN6QixpQ0FBcUQ7O0lBQ3JELG1DQUF5RDs7SUFDekQsOEJBQXlCOztJQUN6QixvQ0FBK0I7O0lBQy9CLHVDQUFrQzs7SUFDbEMsb0NBQWdDOztJQUNoQyxpQ0FBMkI7O0lBQzNCLDhCQUErQzs7SUFDL0MsNkJBQWdDOztJQUVoQywrQkFBMkI7O0lBQzNCLDRCQUFlOztJQUNmLGdDQUEyQjs7SUFDM0IsOEJBQXlCOztJQUV6QixnQ0FBMEI7O0lBQzFCLGlDQUEwQjs7SUFDMUIsaUNBQ21EOztJQUNuRCxrQ0FDcUM7Ozs7O0lBeURuQyw4QkFBMEI7Ozs7O0lBQzFCLDZCQUErQzs7Ozs7SUFDL0MseUJBQXlCOzs7OztJQUN6Qiw0QkFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhbmltSW4sIGFuaW1PdXQgfSBmcm9tICcuL3BvcG92ZXIuYW5pbWF0aW9ucyc7XG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgT25Jbml0LFxuICBWaWV3Q2hpbGQsXG4gIElucHV0LFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgSG9zdCxcbiAgT3B0aW9uYWwsXG4gIEFmdGVyVmlld0luaXQsXG4gIEVsZW1lbnRSZWYsXG4gIE9uRGVzdHJveVxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZpdk92ZXJsYXkgfSBmcm9tICcuLi9vdmVybGF5L292ZXJsYXkuY29tcG9uZW50JztcbmltcG9ydCB7IFBsYXRmb3JtLCBJb25Db250ZW50IH0gZnJvbSAnQGlvbmljL2FuZ3VsYXInO1xuaW1wb3J0IHsgZnJvbUV2ZW50LCBTdWJqZWN0LCBtZXJnZSwgZnJvbSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtcbiAgdGFwLFxuICB0YWtlVW50aWwsXG4gIG1hcCxcbiAgdGhyb3R0bGVUaW1lLFxuICBmaWx0ZXIsXG4gIGZsYXRNYXBcbn0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgTmF2aWdhdGlvblN0YXJ0LCBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHtcbiAgUG9wb3ZlclBvc2l0aW9uaW5nLFxuICBQb3BvdmVyUG9zaXRpb24sXG4gIFBvcG92ZXJIb3Jpem9udGFsQWxpZ24sXG4gIFBvcG92ZXJWZXJ0aWNhbEFsaWduLFxuICBQb3BvdmVyQXJyb3dQb3NpdGlvbmluZ1xufSBmcm9tICcuL3BvcG92ZXIudHlwZXMnO1xuaW1wb3J0IHsgYWZ0ZXIgfSBmcm9tICdAZml2ZXRocmVlL25neC1yeGpzLWFuaW1hdGlvbnMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdmaXYtcG9wb3ZlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9wb3BvdmVyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vcG9wb3Zlci5jb21wb25lbnQuc2NzcyddLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXG59KVxuZXhwb3J0IGNsYXNzIEZpdlBvcG92ZXIgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XG4gIEBWaWV3Q2hpbGQoRml2T3ZlcmxheSwgeyBzdGF0aWM6IGZhbHNlIH0pIG92ZXJsYXk6IEZpdk92ZXJsYXk7XG4gIEBWaWV3Q2hpbGQoJ2FuaW1hdGlvbicsIHsgc3RhdGljOiBmYWxzZSB9KSBhbmltYXRpb25Db250YWluZXI6IEVsZW1lbnRSZWY7XG5cbiAgQElucHV0KCkgd2lkdGg6IG51bWJlcjtcbiAgQElucHV0KCkgaGVpZ2h0OiBudW1iZXI7XG4gIEBJbnB1dCgpIGFycm93ID0gZmFsc2U7XG4gIEBJbnB1dCgpIGFycm93V2lkdGggPSAyNDtcbiAgQElucHV0KCkgYXJyb3dIZWlnaHQ6IG51bWJlciA9IHRoaXMuYXJyb3dXaWR0aCAvIDEuNjtcbiAgQElucHV0KCkgYXJyb3dQb3NpdGlvbjogUG9wb3ZlckFycm93UG9zaXRpb25pbmcgPSAnYXV0byc7XG4gIEBJbnB1dCgpIGJhY2tkcm9wID0gdHJ1ZTtcbiAgQElucHV0KCkgb3ZlcmxheXNUYXJnZXQgPSB0cnVlO1xuICBASW5wdXQoKSBjbG9zZU9uTmF2aWdhdGlvbiA9IHRydWU7XG4gIEBJbnB1dCgpIHNjcm9sbFRvVGFyZ2V0ID0gZmFsc2U7XG4gIEBJbnB1dCgpIHNjcm9sbFNwZWVkID0gMTAwO1xuICBASW5wdXQoKSBwb3NpdGlvbjogUG9wb3ZlclBvc2l0aW9uaW5nID0gJ2F1dG8nO1xuICBASW5wdXQoKSBjbGFzc2VzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIF9wb3NpdGlvbjogUG9wb3ZlclBvc2l0aW9uO1xuICBoaWRkZW4gPSBmYWxzZTtcbiAgb25EZXN0cm95JCA9IG5ldyBTdWJqZWN0KCk7XG4gIG9uQ2xvc2UkID0gbmV3IFN1YmplY3QoKTtcblxuICBASW5wdXQoKSBpbkR1cmF0aW9uID0gMjAwO1xuICBASW5wdXQoKSBvdXREdXJhdGlvbiA9IDgwO1xuICBASW5wdXQoKSBhbmltYXRpb25JbiA9IChlbGVtZW50OiBFbGVtZW50UmVmKSA9PlxuICAgIGFuaW1JbihlbGVtZW50LCB0aGlzLl9wb3NpdGlvbiwgdGhpcy5pbkR1cmF0aW9uKTtcbiAgQElucHV0KCkgYW5pbWF0aW9uT3V0ID0gKGVsZW1lbnQ6IEVsZW1lbnRSZWYpID0+XG4gICAgYW5pbU91dChlbGVtZW50LCB0aGlzLm91dER1cmF0aW9uKTtcblxuICBnZXQgc3R5bGVzKCkge1xuICAgIGlmICghdGhpcy5fcG9zaXRpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZG9tLmJ5cGFzc1NlY3VyaXR5VHJ1c3RTdHlsZShcbiAgICAgIGAgd2lkdGg6ICR7dGhpcy53aWR0aCA/IHRoaXMud2lkdGggKyAncHgnIDogJ2F1dG8nfTsgXG4gICAgICAgIGhlaWdodDogJHt0aGlzLmhlaWdodCA/IHRoaXMuaGVpZ2h0ICsgJ3B4JyA6ICdhdXRvJ307IFxuICAgICAgICBsZWZ0OiAke3RoaXMuZ2V0Q29udGFpbmVyTGVmdCgpfXB4OyBcbiAgICAgICAgdG9wOiAke3RoaXMuZ2V0Q29udGFpbmVyVG9wKCl9cHg7YFxuICAgICk7XG4gIH1cblxuICBnZXQgdHJpYW5nbGUoKSB7XG4gICAgY29uc3QgaXNIb3Jpem9udGFsID0gWydsZWZ0JywgJ3JpZ2h0J10uc29tZShzID0+IHMgPT09IHRoaXMucG9zaXRpb24pO1xuICAgIGlmIChpc0hvcml6b250YWwpIHtcbiAgICAgIHJldHVybiBgJHt0aGlzLmFycm93SGVpZ2h0fSwwIDAsJHt0aGlzLmFycm93V2lkdGggLyAyfSAke1xuICAgICAgICB0aGlzLmFycm93SGVpZ2h0XG4gICAgICB9LCR7dGhpcy5hcnJvd1dpZHRofWA7XG4gICAgfVxuICAgIHJldHVybiBgMCwke3RoaXMuYXJyb3dIZWlnaHR9ICR7dGhpcy5hcnJvd1dpZHRoIC8gMn0sMCAke3RoaXMuYXJyb3dXaWR0aH0sJHtcbiAgICAgIHRoaXMuYXJyb3dIZWlnaHRcbiAgICB9YDtcbiAgfVxuXG4gIGdldCBzdmdTdHlsZXMoKSB7XG4gICAgaWYgKCF0aGlzLl9wb3NpdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc0hvcml6b250YWwgPSBbJ2xlZnQnLCAncmlnaHQnXS5zb21lKHMgPT4gcyA9PT0gdGhpcy5wb3NpdGlvbik7XG4gICAgY29uc3Qgcm90YXRlID1cbiAgICAgICh0aGlzLnBvc2l0aW9uID09PSAnYXV0bycgJiYgdGhpcy5fcG9zaXRpb24udmVydGljYWwgPT09ICdib3R0b20nKSB8fFxuICAgICAgdGhpcy5wb3NpdGlvbiA9PT0gJ2xlZnQnO1xuICAgIHJldHVybiB0aGlzLmRvbS5ieXBhc3NTZWN1cml0eVRydXN0U3R5bGUoXG4gICAgICBgaGVpZ2h0OiAke2lzSG9yaXpvbnRhbCA/IHRoaXMuYXJyb3dXaWR0aCA6IHRoaXMuYXJyb3dIZWlnaHR9cHg7IFxuICAgICAgd2lkdGg6ICR7aXNIb3Jpem9udGFsID8gdGhpcy5hcnJvd0hlaWdodCA6IHRoaXMuYXJyb3dXaWR0aH1weDsgXG4gICAgICB0b3A6ICR7dGhpcy5nZXRBcnJvd1RvcCgpfXB4OyBcbiAgICAgIGxlZnQ6ICR7dGhpcy5nZXRBcnJvd0xlZnQoKX1weDtcbiAgICAgIHRyYW5zZm9ybTogcm90YXRlWigke3JvdGF0ZSA/IDE4MCA6IDB9ZGVnKTtgXG4gICAgKTtcbiAgfVxuXG4gIGdldCBhbmltYXRpb25TdHlsZXMoKSB7XG4gICAgaWYgKCF0aGlzLl9wb3NpdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5kb20uYnlwYXNzU2VjdXJpdHlUcnVzdFN0eWxlKFxuICAgICAgYGhlaWdodDogJHt0aGlzLmFycm93SGVpZ2h0fXB4OyBcbiAgICAgIHdpZHRoOiAke3RoaXMuYXJyb3dXaWR0aH1weDsgXG4gICAgICB0b3A6ICR7dGhpcy5nZXRBcnJvd1RvcCgpfXB4OyBcbiAgICAgIGxlZnQ6ICR7dGhpcy5nZXRBcnJvd0xlZnQoKX1weDtcbiAgICAgIHRyYW5zZm9ybTogcm90YXRlWigke3RoaXMuX3Bvc2l0aW9uLnZlcnRpY2FsID09PSAnYm90dG9tJyA/IDE4MCA6IDB9ZGVnKTtgXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcGxhdGZvcm06IFBsYXRmb3JtLFxuICAgIEBIb3N0KCkgQE9wdGlvbmFsKCkgcHJpdmF0ZSBjb250ZW50OiBJb25Db250ZW50LFxuICAgIHByaXZhdGUgZG9tOiBEb21TYW5pdGl6ZXIsXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlclxuICApIHt9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5yb3V0ZXIuZXZlbnRzXG4gICAgICAucGlwZShcbiAgICAgICAgZmlsdGVyPE5hdmlnYXRpb25TdGFydD4oZXZlbnQgPT4gZXZlbnQgaW5zdGFuY2VvZiBOYXZpZ2F0aW9uU3RhcnQpLFxuICAgICAgICBmaWx0ZXIoKCkgPT4gdGhpcy5jbG9zZU9uTmF2aWdhdGlvbiAmJiB0aGlzLm92ZXJsYXkub3BlbiksXG4gICAgICAgIHRhcCgoKSA9PiB0aGlzLmNsb3NlKCkpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge31cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLm9uRGVzdHJveSQubmV4dCgpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5hbmltYXRpb25PdXQodGhpcy5hbmltYXRpb25Db250YWluZXIpXG4gICAgICAucGlwZShcbiAgICAgICAgYWZ0ZXIoKCkgPT4ge1xuICAgICAgICAgIHRoaXMub3ZlcmxheS5oaWRlKCk7XG4gICAgICAgICAgdGhpcy5vbkNsb3NlJC5uZXh0KCk7XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBwcml2YXRlIGdldFBvc2l0aW9uT2ZUYXJnZXQodGFyZ2V0OiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHRoaXMuY2FsY3VsY2F0ZVBvc2l0aW9uaW5nKFxuICAgICAgcmVjdC50b3AsXG4gICAgICByZWN0LmxlZnQsXG4gICAgICByZWN0LmJvdHRvbSxcbiAgICAgIHJlY3QucmlnaHQsXG4gICAgICByZWN0LmhlaWdodCxcbiAgICAgIHJlY3Qud2lkdGhcbiAgICApO1xuICB9XG5cbiAgb3Blbih0YXJnZXQ6IE1vdXNlRXZlbnQgfCBFbGVtZW50UmVmKSB7XG4gICAgbGV0IGVsZW1lbnQ7XG4gICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQpIHtcbiAgICAgIGVsZW1lbnQgPSB0YXJnZXQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgIH0gZWxzZSBpZiAodGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudFJlZikge1xuICAgICAgZWxlbWVudCA9IHRhcmdldC5uYXRpdmVFbGVtZW50IGFzIEhUTUxFbGVtZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMub3BlblRhcmdldChlbGVtZW50KTtcbiAgfVxuXG4gIG9wZW5UYXJnZXQodGFyZ2V0OiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5nZXRQb3NpdGlvbk9mVGFyZ2V0KHRhcmdldCk7XG4gICAgdGhpcy5vcGVuQXRQb3NpdGlvbih0YXJnZXQsIHBvc2l0aW9uKTtcbiAgICB0aGlzLndhdGNoUmVzaXplKHRhcmdldCk7XG4gICAgdGhpcy53YXRjaFNjcm9sbCh0YXJnZXQpO1xuICB9XG5cbiAgcHJpdmF0ZSB3YXRjaFJlc2l6ZSh0YXJnZXQ6IEhUTUxFbGVtZW50KSB7XG4gICAgZnJvbUV2ZW50KHdpbmRvdywgJ3Jlc2l6ZScpXG4gICAgICAucGlwZShcbiAgICAgICAgZmxhdE1hcCgoKSA9PiB0aGlzLmZpbHRlckluVmlld3BvcnQodGFyZ2V0KSksXG4gICAgICAgIHRocm90dGxlVGltZSg1MCksXG4gICAgICAgIG1hcCgoKSA9PiB0aGlzLmdldFBvc2l0aW9uT2ZUYXJnZXQodGFyZ2V0KSksXG4gICAgICAgIHRhcChwb3MgPT4gKHRoaXMuX3Bvc2l0aW9uID0gcG9zKSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBwcml2YXRlIHdhdGNoU2Nyb2xsKHRhcmdldDogSFRNTEVsZW1lbnQpIHtcbiAgICBpZiAodGhpcy5jb250ZW50ICYmICF0aGlzLmJhY2tkcm9wKSB7XG4gICAgICB0aGlzLmNvbnRlbnQuc2Nyb2xsRXZlbnRzID0gdHJ1ZTtcbiAgICAgIG1lcmdlKFxuICAgICAgICBmcm9tRXZlbnQod2luZG93LCAnbW91c2V3aGVlbCcpLFxuICAgICAgICBmcm9tRXZlbnQod2luZG93LCAndG91Y2htb3ZlJyksXG4gICAgICAgIHRoaXMuY29udGVudC5pb25TY3JvbGxcbiAgICAgIClcbiAgICAgICAgLnBpcGUoXG4gICAgICAgICAgZmxhdE1hcCgoKSA9PiB0aGlzLmZpbHRlckluVmlld3BvcnQodGFyZ2V0KSksXG4gICAgICAgICAgbWFwKCgpID0+IHRoaXMuZ2V0UG9zaXRpb25PZlRhcmdldCh0YXJnZXQpKSxcbiAgICAgICAgICB0YXAocG9zID0+ICh0aGlzLl9wb3NpdGlvbiA9IHBvcykpLFxuICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgIClcbiAgICAgICAgLnN1YnNjcmliZSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZmlsdGVySW5WaWV3cG9ydCh0YXJnZXQ6IEhUTUxFbGVtZW50KSB7XG4gICAgcmV0dXJuIGZyb20odGhpcy5pblZpZXdwb3J0KHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSkpLnBpcGUoXG4gICAgICB0YXAoaW5WaWV3cG9ydCA9PlxuICAgICAgICAhaW5WaWV3cG9ydCA/ICh0aGlzLmhpZGRlbiA9IHRydWUpIDogKHRoaXMuaGlkZGVuID0gZmFsc2UpXG4gICAgICApLFxuICAgICAgZmlsdGVyKGluVmlld1BvcnQgPT4gdGhpcy5vdmVybGF5Lm9wZW4gJiYgaW5WaWV3UG9ydClcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBvcGVuQXRQb3NpdGlvbih0YXJnZXQ6IEhUTUxFbGVtZW50LCBwb3NpdGlvbjogUG9wb3ZlclBvc2l0aW9uKSB7XG4gICAgYXdhaXQgdGhpcy5zY3JvbGxUb1Bvc2l0aW9uKHRhcmdldCwgcG9zaXRpb24pO1xuICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XG4gICAgdGhpcy5vdmVybGF5LnNob3coKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2Nyb2xsVG9Qb3NpdGlvbihcbiAgICB0YXJnZXQ6IEhUTUxFbGVtZW50LFxuICAgIHBvc2l0aW9uOiBQb3BvdmVyUG9zaXRpb25cbiAgKSB7XG4gICAgaWYgKHRoaXMuY29udGVudCAmJiB0aGlzLnNjcm9sbFRvVGFyZ2V0KSB7XG4gICAgICBjb25zdCBpc0luVmlld3BvcnQgPSBhd2FpdCB0aGlzLmluVmlld3BvcnQoXG4gICAgICAgIHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgKTtcbiAgICAgIGlmIChpc0luVmlld3BvcnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5jb250ZW50LnNjcm9sbFRvUG9pbnQoXG4gICAgICAgIHBvc2l0aW9uLmxlZnQsXG4gICAgICAgIHBvc2l0aW9uLnRvcCxcbiAgICAgICAgdGhpcy5zY3JvbGxTcGVlZFxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgaW5WaWV3cG9ydChwb3NpdGlvbjogRE9NUmVjdCB8IENsaWVudFJlY3QpIHtcbiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLnBsYXRmb3JtLmhlaWdodCgpO1xuICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wbGF0Zm9ybS53aWR0aCgpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIHBvc2l0aW9uLnRvcCA8PSBoZWlnaHQgJiZcbiAgICAgIHBvc2l0aW9uLmJvdHRvbSA+PSAwICYmXG4gICAgICBwb3NpdGlvbi5sZWZ0IDwgd2lkdGggJiZcbiAgICAgIHBvc2l0aW9uLnJpZ2h0ID4gMFxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGNhdGVQb3NpdGlvbmluZyhcbiAgICB0b3A6IG51bWJlcixcbiAgICBsZWZ0OiBudW1iZXIsXG4gICAgYm90dG9tOiBudW1iZXIsXG4gICAgcmlnaHQ6IG51bWJlcixcbiAgICB0YXJnZXRIZWlnaHQ6IG51bWJlcixcbiAgICB0YXJnZXRXaWR0aDogbnVtYmVyXG4gICk6IFBvcG92ZXJQb3NpdGlvbiB7XG4gICAgLy8gY2FsY3VsYXRlcyB0aGUgcG9zaXRpb24gb2YgdGhlIHBvcG92ZXIgd2l0aG91dCBjb25zaWRlcmluZyBhcnJvdyBhbmQgb3ZlcmxheSBvZmZzZXRcbiAgICBjb25zdCB3aWR0aCA9IHRoaXMucGxhdGZvcm0ud2lkdGgoKTtcbiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLnBsYXRmb3JtLmhlaWdodCgpO1xuXG4gICAgY29uc3QgX2xlZnQgPVxuICAgICAgdGhpcy5wb3NpdGlvbiA9PT0gJ3JpZ2h0JyB8fFxuICAgICAgKHdpZHRoIC8gMiA+IGxlZnQgJiYgdGhpcy5wb3NpdGlvbiAhPT0gJ2xlZnQnKTtcbiAgICBjb25zdCBfcmlnaHQgPVxuICAgICAgdGhpcy5wb3NpdGlvbiA9PT0gJ2xlZnQnIHx8XG4gICAgICAod2lkdGggLyAyIDw9IGxlZnQgJiYgdGhpcy5wb3NpdGlvbiAhPT0gJ3JpZ2h0Jyk7XG4gICAgY29uc3QgX3RvcCA9XG4gICAgICB0aGlzLnBvc2l0aW9uID09PSAnYmVsb3cnIHx8XG4gICAgICAoaGVpZ2h0IC8gMiA+IHRvcCAmJiB0aGlzLnBvc2l0aW9uICE9PSAnYWJvdmUnKTtcbiAgICBjb25zdCBfYm90dG9tID1cbiAgICAgIHRoaXMucG9zaXRpb24gPT09ICdhYm92ZScgfHxcbiAgICAgIChoZWlnaHQgLyAyIDw9IHRvcCAmJiB0aGlzLnBvc2l0aW9uICE9PSAnYmVsb3cnKTtcblxuICAgIC8vIHRyYW5zZm9ybSBvcmlnaW5cbiAgICBsZXQgaG9yaXpvbnRhbDogUG9wb3Zlckhvcml6b250YWxBbGlnbiA9ICdsZWZ0JztcbiAgICBsZXQgdmVydGljYWw6IFBvcG92ZXJWZXJ0aWNhbEFsaWduID0gJ3RvcCc7XG5cbiAgICBpZiAoX2xlZnQgJiYgX3RvcCkge1xuICAgICAgLy8gdG9wIGxlZnRcbiAgICAgIGhvcml6b250YWwgPSAnbGVmdCc7XG4gICAgICB2ZXJ0aWNhbCA9ICd0b3AnO1xuICAgIH0gZWxzZSBpZiAoX3JpZ2h0ICYmIF9ib3R0b20pIHtcbiAgICAgIC8vIGJvdHRvbSByaWdodFxuICAgICAgbGVmdCA9IHJpZ2h0IC0gdGhpcy53aWR0aDtcbiAgICAgIHRvcCA9IGJvdHRvbSAtIHRoaXMuaGVpZ2h0O1xuICAgICAgaG9yaXpvbnRhbCA9ICdyaWdodCc7XG4gICAgICB2ZXJ0aWNhbCA9ICdib3R0b20nO1xuICAgIH0gZWxzZSBpZiAoX3JpZ2h0ICYmIF90b3ApIHtcbiAgICAgIC8vIHRvcCByaWdodFxuICAgICAgbGVmdCA9IHJpZ2h0IC0gdGhpcy53aWR0aDtcbiAgICAgIGhvcml6b250YWwgPSAncmlnaHQnO1xuICAgICAgdmVydGljYWwgPSAndG9wJztcbiAgICB9IGVsc2UgaWYgKF9sZWZ0ICYmIF9ib3R0b20pIHtcbiAgICAgIC8vIGJvdHRvbSBsZWZ0XG4gICAgICB0b3AgPSBib3R0b20gLSB0aGlzLmhlaWdodDtcbiAgICAgIGhvcml6b250YWwgPSAnbGVmdCc7XG4gICAgICB2ZXJ0aWNhbCA9ICdib3R0b20nO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0b3AsXG4gICAgICBsZWZ0LFxuICAgICAgYm90dG9tLFxuICAgICAgcmlnaHQsXG4gICAgICB0YXJnZXRIZWlnaHQsXG4gICAgICB0YXJnZXRXaWR0aCxcbiAgICAgIGhvcml6b250YWwsXG4gICAgICB2ZXJ0aWNhbFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdldEFycm93VG9wKCkge1xuICAgIGNvbnN0IGlzVmVydCA9IFsnYXV0bycsICdiZWxvdycsICdhYm92ZSddLnNvbWUocyA9PiBzID09PSB0aGlzLnBvc2l0aW9uKTtcbiAgICBpZiAoaXNWZXJ0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb24udmVydGljYWwgPT09ICd0b3AnXG4gICAgICAgID8gLTEgKiB0aGlzLmFycm93SGVpZ2h0XG4gICAgICAgIDogdGhpcy5oZWlnaHQ7XG4gICAgfVxuICAgIGlmICh0aGlzLmFycm93UG9zaXRpb24gPT09ICdjZW50ZXInKSB7XG4gICAgICByZXR1cm4gdGhpcy5oZWlnaHQgLyAyIC0gdGhpcy5hcnJvd1dpZHRoIC8gMjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uLnZlcnRpY2FsID09PSAndG9wJ1xuICAgICAgPyB0aGlzLl9wb3NpdGlvbi50YXJnZXRIZWlnaHQgLyAyIC0gdGhpcy5hcnJvd0hlaWdodCAvIDJcbiAgICAgIDogdGhpcy5oZWlnaHQgLSB0aGlzLmFycm93SGVpZ2h0IC8gMiAtIHRoaXMuX3Bvc2l0aW9uLnRhcmdldEhlaWdodCAvIDI7XG4gIH1cblxuICBwcml2YXRlIGdldEFycm93TGVmdCgpIHtcbiAgICBjb25zdCBpc0hvcml6b250YWwgPSBbJ2xlZnQnLCAncmlnaHQnXS5zb21lKHMgPT4gcyA9PT0gdGhpcy5wb3NpdGlvbik7XG4gICAgaWYgKGlzSG9yaXpvbnRhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uLmhvcml6b250YWwgPT09ICdsZWZ0J1xuICAgICAgICA/IC0xICogdGhpcy5hcnJvd0hlaWdodFxuICAgICAgICA6IHRoaXMud2lkdGg7XG4gICAgfVxuICAgIGlmICh0aGlzLmFycm93UG9zaXRpb24gPT09ICdjZW50ZXInKSB7XG4gICAgICByZXR1cm4gdGhpcy53aWR0aCAvIDIgLSB0aGlzLmFycm93SGVpZ2h0IC8gMjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uLmhvcml6b250YWwgPT09ICdsZWZ0J1xuICAgICAgPyB0aGlzLl9wb3NpdGlvbi50YXJnZXRXaWR0aCAvIDIgLSB0aGlzLmFycm93V2lkdGggLyAyXG4gICAgICA6IHRoaXMud2lkdGggLSB0aGlzLmFycm93V2lkdGggLyAyIC0gdGhpcy5fcG9zaXRpb24udGFyZ2V0V2lkdGggLyAyO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250YWluZXJUb3AoKSB7XG4gICAgY29uc3QgaXNWZXJ0ID0gWydhdXRvJywgJ2JlbG93JywgJ2Fib3ZlJ10uc29tZShzID0+IHMgPT09IHRoaXMucG9zaXRpb24pO1xuICAgIGNvbnN0IGlzVG9wID0gdGhpcy5fcG9zaXRpb24udmVydGljYWwgPT09ICd0b3AnO1xuXG4gICAgbGV0IG9mZnNldCA9IDA7XG4gICAgaWYgKHRoaXMuYXJyb3cgJiYgaXNUb3ApIHtcbiAgICAgIG9mZnNldCAtPSB0aGlzLmdldFZlcnRpY2FsQXJyb3dPZmZzZXQoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYXJyb3cgJiYgIWlzVG9wKSB7XG4gICAgICBvZmZzZXQgKz0gdGhpcy5nZXRWZXJ0aWNhbEFycm93T2Zmc2V0KCk7XG4gICAgfVxuICAgIGlmICghaXNWZXJ0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb24udG9wICsgb2Zmc2V0O1xuICAgIH1cbiAgICBpZiAoIXRoaXMub3ZlcmxheXNUYXJnZXQgJiYgaXNUb3ApIHtcbiAgICAgIG9mZnNldCArPSB0aGlzLl9wb3NpdGlvbi50YXJnZXRIZWlnaHQ7XG4gICAgfSBlbHNlIGlmICghdGhpcy5vdmVybGF5c1RhcmdldCAmJiAhaXNUb3ApIHtcbiAgICAgIG9mZnNldCAtPSB0aGlzLl9wb3NpdGlvbi50YXJnZXRIZWlnaHQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYXJyb3cgJiYgaXNUb3ApIHtcbiAgICAgIG9mZnNldCArPSB0aGlzLmFycm93SGVpZ2h0O1xuICAgIH0gZWxzZSBpZiAodGhpcy5hcnJvdyAmJiAhaXNUb3ApIHtcbiAgICAgIG9mZnNldCAtPSB0aGlzLmFycm93SGVpZ2h0O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fcG9zaXRpb24udG9wICsgb2Zmc2V0O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRWZXJ0aWNhbEFycm93T2Zmc2V0KCkge1xuICAgIGxldCBvZmZzZXQgPSAwO1xuICAgIGNvbnN0IGlzSG9yaXpvbnRhbCA9IFsnbGVmdCcsICdyaWdodCddLnNvbWUocyA9PiBzID09PSB0aGlzLnBvc2l0aW9uKTtcbiAgICBpZiAodGhpcy5hcnJvd1Bvc2l0aW9uID09PSAnY2VudGVyJyAmJiBpc0hvcml6b250YWwpIHtcbiAgICAgIG9mZnNldCArPSB0aGlzLmhlaWdodCAvIDIgLSB0aGlzLl9wb3NpdGlvbi50YXJnZXRIZWlnaHQgLyAyO1xuICAgIH1cbiAgICByZXR1cm4gb2Zmc2V0O1xuICB9XG4gIHByaXZhdGUgZ2V0SG9yaXpvbnRhbEFycm93T2Zmc2V0KCkge1xuICAgIGxldCBvZmZzZXQgPSAwO1xuICAgIGNvbnN0IGlzVmVydGljYWwgPSBbJ2Fib3ZlJywgJ2F1dG8nLCAnYmVsb3cnXS5zb21lKFxuICAgICAgcyA9PiBzID09PSB0aGlzLnBvc2l0aW9uXG4gICAgKTtcbiAgICBpZiAodGhpcy5hcnJvd1Bvc2l0aW9uID09PSAnY2VudGVyJyAmJiBpc1ZlcnRpY2FsKSB7XG4gICAgICBvZmZzZXQgKz0gdGhpcy53aWR0aCAvIDIgLSB0aGlzLl9wb3NpdGlvbi50YXJnZXRXaWR0aCAvIDI7XG4gICAgfVxuICAgIHJldHVybiBvZmZzZXQ7XG4gIH1cblxuICBwcml2YXRlIGdldENvbnRhaW5lckxlZnQoKSB7XG4gICAgY29uc3QgaXNIb3Jpem9udGFsID0gWydsZWZ0JywgJ3JpZ2h0J10uc29tZShzID0+IHMgPT09IHRoaXMucG9zaXRpb24pO1xuICAgIGNvbnN0IGlzTGVmdCA9IHRoaXMuX3Bvc2l0aW9uLmhvcml6b250YWwgPT09ICdsZWZ0JztcblxuICAgIGxldCBvZmZzZXQgPSAwO1xuICAgIGlmICh0aGlzLmFycm93ICYmIGlzTGVmdCkge1xuICAgICAgb2Zmc2V0IC09IHRoaXMuZ2V0SG9yaXpvbnRhbEFycm93T2Zmc2V0KCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmFycm93ICYmICFpc0xlZnQpIHtcbiAgICAgIG9mZnNldCArPSB0aGlzLmdldEhvcml6b250YWxBcnJvd09mZnNldCgpO1xuICAgIH1cblxuICAgIGlmICghaXNIb3Jpem9udGFsKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb24ubGVmdCArIG9mZnNldDtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm92ZXJsYXlzVGFyZ2V0ICYmIGlzTGVmdCkge1xuICAgICAgb2Zmc2V0ICs9IHRoaXMuX3Bvc2l0aW9uLnRhcmdldFdpZHRoO1xuICAgIH0gZWxzZSBpZiAoIXRoaXMub3ZlcmxheXNUYXJnZXQgJiYgIWlzTGVmdCkge1xuICAgICAgb2Zmc2V0IC09IHRoaXMuX3Bvc2l0aW9uLnRhcmdldFdpZHRoO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFycm93ICYmIGlzTGVmdCkge1xuICAgICAgb2Zmc2V0ICs9IHRoaXMuYXJyb3dIZWlnaHQ7XG4gICAgfSBlbHNlIGlmICh0aGlzLmFycm93ICYmICFpc0xlZnQpIHtcbiAgICAgIG9mZnNldCAtPSB0aGlzLmFycm93SGVpZ2h0O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fcG9zaXRpb24ubGVmdCArIG9mZnNldDtcbiAgfVxufVxuIl19